<div id="recommendationSection" style="display:none; margin-bottom: 40px;">
    <h2 style="color: var(--primary); border-bottom: 2px solid var(--primary); padding-bottom: 10px;">Top 3 Recommendations</h2>
    <div id="topPicks" class="tire-grid"></div>
</div>

<div id="resultCount" class="results-meta"></div>
<div id="tireGrid" class="tire-grid"></div>

<script>
// (Keep your 'const tires = [...]' list here - just ensure the very end of the list is clean)

function filterData() {
    const ride = document.getElementById('rideType').value;
    const terrain = document.getElementById('terrainType').value;
    const search = document.getElementById('searchText').value.toLowerCase();
    
    const grid = document.getElementById('tireGrid');
    const topPicksGrid = document.getElementById('topPicks');
    const recSection = document.getElementById('recommendationSection');
    const count = document.getElementById('resultCount');

    // 1. Filter the full list
    const filtered = tires.filter(t => {
        const matchRide = ride === 'all' || t.r === ride;
        const matchTerr = terrain === 'all' || t.t === terrain;
        const matchSearch = t.m.toLowerCase().includes(search) || t.b.toLowerCase().includes(search);
        return matchRide && matchTerr && matchSearch;
    });

    // 2. Logic for Recommendation Section
    // Only show "Top Picks" if the user has actually selected a specific style or terrain
    if ((ride !== 'all' || terrain !== 'all') && filtered.length > 0) {
        recSection.style.display = 'block';
        const top3 = filtered.slice(0, 3);
        topPicksGrid.innerHTML = top3.map(t => createCardHTML(t, true)).join('');
    } else {
        recSection.style.display = 'none';
    }

    // 3. Show the rest of the results
    count.innerText = `${filtered.length} Total Models Found`;
    grid.innerHTML = filtered.map(t => createCardHTML(t, false)).join('');
}

// Helper function to build the card so we don't repeat code
function createCardHTML(t, isRecommended) {
    const borderStyle = isRecommended ? 'border: 2px solid var(--primary);' : '';
    return `
        <div class="tire-card" style="${borderStyle}">
            <div class="brand-name">
                ${t.b} ${t.u ? '<span class="update-tag">NEW 2026</span>' : ''}
                ${isRecommended ? '<span style="background:var(--primary); color:white; padding:2px 6px; border-radius:4px; font-size:0.7rem; margin-left:5px;">BEST MATCH</span>' : ''}
            </div>
            <div class="model-name">${t.m}</div>
            <div class="badges">
                <span class="badge badge-pos">${t.p}</span>
                <span class="badge badge-ride">${t.r || 'Off-Road'}</span>
                <span class="badge badge-terr">${t.t || 'Mixed'}</span>
            </div>
            <div class="description">${t.d}</div>
        </div>
    `;
}

// Initial Run
filterData();
</script>
